(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{53:function(e,t,n){e.exports=n(97)},59:function(e,t,n){},60:function(e,t,n){},97:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(26),s=n.n(r),o=(n(59),n(7)),d=n(13),l=n(12),c=n(14),u=n(8),h=n(9),m=n(51),p=n.n(m),f=n(27),w=n.n(f),v=n(22),b=n.n(v),g=n(29),y=n.n(g),E=n(21),j=n.n(E),O=n(10),S=n.n(O),k=n(28),F=n.n(k),L=n(11),N=n.n(L),I=n(52),T=n.n(I),C=n(50),A=n.n(C),U=n(30),x=n.n(U),R=n(31),P=n.n(R),B=(n(60),function(){function e(t,n,a){Object(u.a)(this,e),this.name=t,this.type=n,this.key=a.split("."),this.quote=!this.type.startsWith("int")&&!this.type.startsWith("dec")}return Object(h.a)(e,[{key:"getValue",value:function(e){for(var t=e,n=0;n<this.key.length;++n)if(null===(t=t[this.key[n]])||"undefined"===typeof t)return"null";return t=(t=String(t)).split('"').join('\\"'),this.quote?'"'+t+'"':t}}]),e}()),z=function(){function e(t){Object(u.a)(this,e),this.keys=[],this.name=t,this.data={},this.fields=[],this.key="`id`"}return Object(h.a)(e,[{key:"addField",value:function(e){this.fields.push(e)}},{key:"setKey",value:function(e){this.key=e}},{key:"add",value:function(e){this.keys.includes(e.id)||(this.data[e.id]=e,this.keys.push(e.id))}},{key:"generateInsert",value:function(e){var t=this.fields.map(function(t){return t.getValue(e)});return"INSERT INTO "+this.name+" VALUES ("+t.join()+");\n"}},{key:"generateAllInsert",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n="";return null==t&&(t=this.keys),t.forEach(function(t){n+=e.generateInsert(e.data[t])}),n}},{key:"generateCreateStatement",value:function(){var e="CREATE TABLE IF NOT EXISTS "+this.name+" (\n";return this.fields.forEach(function(t){e+="`"+t.name+"` "+t.type+",\n"}),e+="PRIMARY KEY ("+this.key+")\n",e+=") ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\n\n"}}]),e}(),Q=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props.show.image?i.a.createElement(S.a,{sm:"4"},i.a.createElement(A.a,{src:this.props.show.image.medium,rounded:!0,fluid:!0})):i.a.createElement(S.a,{sm:"4"});return i.a.createElement(F.a,null,e,i.a.createElement(S.a,{sm:"8"},i.a.createElement("h4",null,this.props.show.name),this.props.children))}}]),t}(a.Component),D=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){return i.a.createElement(N.a,{bg:"secondary",text:"white"},i.a.createElement(N.a.Header,null,i.a.createElement(N.a.Title,null,this.props.show.name)),this.props.show.image?i.a.createElement(N.a.Img,{variant:"top",src:this.props.show.image.medium}):i.a.createElement(N.a.Text,null,"Pas d image"),i.a.createElement(N.a.Body,null,i.a.createElement(N.a.Text,{dangerouslySetInnerHTML:{__html:this.props.show.summary}})))}}]),t}(a.Component),V=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement(j.a.Content,null,this.props.table.keys.map(function(t){return i.a.createElement(j.a.Pane,{eventKey:"#"+t.toString(),key:t.toString()},i.a.createElement(D,{show:e.props.table.data[t]}))}))}}]),t}(a.Component),q=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this;return this.props.list?i.a.createElement(y.a,null,this.props.list.map(function(t){return i.a.createElement(y.a.Item,{key:t.toString(),action:!0,href:"#"+t.toString()},i.a.createElement(Q,{show:e.props.table.data[t]},i.a.createElement(b.a,{variant:"secondary",onClick:function(){return e.props.onClick(t)},size:"lg"},e.props.textButton)))})):i.a.createElement("div",null,"Pas de r\xe9sultat")}}]),t}(a.Component),K=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(l.a)(t).call(this,e))).state={found:null,selection:[]},n.textInput=i.a.createRef(),n.serie=new z("serie"),n.serie.addField(new B("id","int(11) NOT NULL","id")),n.serie.addField(new B("nom","varchar(255) NOT NULL","name")),n.serie.addField(new B("resume","text","summary")),n.serie.addField(new B("langue","varchar(255)","language")),n.serie.addField(new B("note","decimal(4,2)","rating.average")),n.serie.addField(new B("statut","varchar(64)","status")),n.serie.addField(new B("premiere","date","premiered")),n.serie.addField(new B("url","varchar(255)","url")),n.serie.addField(new B("urlImage","varchar(255)","image.medium")),n.personnage=new z("personnage"),n.personnage.addField(new B("id","int(11) NOT NULL","id")),n.personnage.addField(new B("nom","varchar(255) NOT NULL","name")),n.personnage.addField(new B("urlImage","varchar(255)","image.medium")),n.personne=new z("personne"),n.personne.addField(new B("id","int(11) NOT NULL","id")),n.personne.addField(new B("nom","varchar(255) NOT NULL","name")),n.personne.addField(new B("urlImage","varchar(255)","image.medium")),n.personne.addField(new B("url","varchar(255)","url")),n.personne.addField(new B("naissance","date","birthday")),n.personne.addField(new B("mort","date","deathday")),n.personne.addField(new B("pays","varchar(255)","country.name")),n.jouer=new z("jouer"),n.jouer.addField(new B("idSerie","int(11) NOT NULL","idSerie")),n.jouer.addField(new B("idPersonnage","int(11) NOT NULL","idPersonnage")),n.jouer.addField(new B("idPersonne","int(11) NOT NULL","idPersonne")),n.jouer.setKey("`idSerie`,`idPersonnage`,`idPersonne`"),n.episode=new z("episode"),n.episode.addField(new B("id","int(11) NOT NULL","id")),n.episode.addField(new B("nom","varchar(255) NOT NULL","name")),n.episode.addField(new B("idSerie","int(11) NOT NULL","idSerie")),n.episode.addField(new B("resume","text","summary")),n.episode.addField(new B("numero","int(11)","number")),n.episode.addField(new B("saison","int(11)","season")),n.episode.addField(new B("premiere","date","airdate")),n.episode.addField(new B("urlImage","varchar(255)","image.medium")),n.episode.addField(new B("url","varchar(255)","url")),n.handleSubmit=n.handleSubmit.bind(Object(o.a)(Object(o.a)(n))),n.handleRemoveShow=n.handleRemoveShow.bind(Object(o.a)(Object(o.a)(n))),n.handleAddShow=n.handleAddShow.bind(Object(o.a)(Object(o.a)(n))),n.downloadSQLFile=n.downloadSQLFile.bind(Object(o.a)(Object(o.a)(n))),n}return Object(c.a)(t,e),Object(h.a)(t,[{key:"handleSubmit",value:function(e){var t=this,n=this.textInput.current.value;fetch("https://api.tvmaze.com/search/shows?q="+n).then(function(e){return e.json()}).then(function(e){for(var n in e)t.serie.add(e[n].show);t.setState({found:e.map(function(e){return e.show.id})})}),e.preventDefault()}},{key:"handleRemoveShow",value:function(e){this.setState({selection:this.state.selection.filter(function(t){return t!==e})})}},{key:"handleAddShow",value:function(e){var t=this;fetch("https://api.tvmaze.com/shows/"+e+"?embed[]=cast&embed[]=episodes").then(function(e){return e.json()}).then(function(n){for(var a=n._embedded.cast,i=0;i<a.length;++i){t.personne.add(a[i].person),t.personnage.add(a[i].character);var r=a[i].person.id,s=a[i].character.id;t.jouer.add({id:e+"/"+r+"/"+s,idSerie:e,idPersonnage:s,idPersonne:r})}for(var o=n._embedded.episodes,d=0;d<o.length;++d)o[d].idSerie=e,t.episode.add(o[d]);t.setState(function(t){return{selection:t.selection.concat([e]),found:t.found.filter(function(t){return t!==e})}})})}},{key:"downloadSQLFile",value:function(){var e="# Fichier g\xe9n\xe9r\xe9 avec les donn\xe9es de TVmaze, en CC-BY-SA. https://www.tvmaze.com/api \n";e+="# Liste des s\xe9ries incluses, par id :\n",e+="# "+this.state.selection.join(",")+"\n\n\n",e+=this.serie.generateCreateStatement(),e+=this.personne.generateCreateStatement(),e+=this.personnage.generateCreateStatement(),e+=this.jouer.generateCreateStatement(),e+=this.episode.generateCreateStatement(),e+=this.serie.generateAllInsert(this.state.selection),e+=this.personne.generateAllInsert(),e+=this.personnage.generateAllInsert(),e+=this.jouer.generateAllInsert(),e+=this.episode.generateAllInsert(),console.log(e);var t=document.createElement("a"),n=new Blob([e],{type:"text/plain"});t.href=URL.createObjectURL(n),t.download="tvshows.sql",document.body.appendChild(t),t.click()}},{key:"render",value:function(){return i.a.createElement(j.a.Container,null,i.a.createElement(x.a,{bg:"dark",variant:"dark"},i.a.createElement(x.a.Brand,{href:"#home"},"Series2SQL"),i.a.createElement(P.a,{className:"mr-auto"},i.a.createElement(P.a.Link,{href:"https://www.tvmaze.com/api"},"Donn\xe9es : TVMaze API"),i.a.createElement(b.a,{variant:"outline-info",disabled:0===this.state.selection.length,onClick:this.downloadSQLFile},"Exporter la s\xe9lection en SQL")),i.a.createElement(p.a,{inline:!0,onSubmit:this.handleSubmit},i.a.createElement(w.a,{type:"text",placeholder:"Nom de la s\xe9rie",className:"mr-sm-2",ref:this.textInput,autoFocus:!0}),i.a.createElement(b.a,{variant:"outline-info",type:"submit"},"Rechercher"))),i.a.createElement("div",{style:{marginTop:"1em"}}),i.a.createElement(F.a,null,i.a.createElement(S.a,{sm:4},i.a.createElement("h4",null,"S\xe9lection ",i.a.createElement(T.a,{pill:!0,variant:"info"},this.state.selection.length," s\xe9ries")),i.a.createElement(q,{list:this.state.selection,table:this.serie,onClick:this.handleRemoveShow,textButton:"Retirer"})),i.a.createElement(S.a,{sm:4},i.a.createElement("h4",null,"R\xe9sultats de recherche"),i.a.createElement(q,{list:this.state.found,table:this.serie,onClick:this.handleAddShow,textButton:"Ajouter"})),i.a.createElement(S.a,{sm:4},i.a.createElement("h4",null,"D\xe9tail de la s\xe9lection"),i.a.createElement(V,{table:this.serie}))))}}]),t}(a.Component),W=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"App"},i.a.createElement(K,null))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(96);s.a.render(i.a.createElement(W,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[53,1,2]]]);
//# sourceMappingURL=main.d4b16c5a.chunk.js.map